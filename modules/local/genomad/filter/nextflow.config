process {
    withName: FILTERSEQUENCES {
        ext.args = [
            params.genomad_min_viral_score ? "--genomad_min_viral_score ${params.genomad_min_viral_score}" : "",
            params.genomad_min_viral_score ? "--genomad_max_fdr ${params.genomad_min_viral_score}" : "",
            params.checkv_min_length ? "--checkv_min_length ${params.checkv_min_length}" : "",
            params.checkv_min_aai_completeness ? "--checkv_min_aai_completeness ${params.checkv_min_aai_completeness}" : "",
            params.checkv_min_hmm_completeness ? "--checkv_min_hmm_completeness ${params.checkv_min_hmm_completeness}" : "",
            params.min_cds_density ? "--min_cds_density ${params.min_cds_density}" : "",
            params.max_tantan_frac ? "--max_tantan_frac ${params.max_tantan_frac}" : "",
            params.max_kmer_freq ? "--max_kmer_freq ${params.max_kmer_freq}" : "",
            params.max_n_frac ? "--max_n_frac ${params.max_n_frac}" : "",
        ].join(" ").trim()
        publishDir = [
            [
            path: { "${params.outdir}/VirusFilter" },
            mode: params.publish_dir_mode,
            pattern: '*_filtered.fasta.gz'
            ],
            [
            path: { "${params.outdir}/VirusFilter" },
            mode: params.publish_dir_mode,
            pattern: '*_filtering_data.tsv'
            ]
        ]
    }
}
